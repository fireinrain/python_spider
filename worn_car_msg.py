#! /usr/bin/python3
# _encoding:utf-8_
# Written by liuzhaoyang
"""
爬取一个js动态加载的网页数据
url='http://www.dpac.gov.cn/cpqxcj/VehicleComplaintPublicity.aspx'
分析post数据发现post数据在点击下一页会发生变化
url并不发生生变化
"""

import requests
import http.cookiejar
import time


headers = {'User-Agent': 'Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:48.0) Gecko/20100101 Firefox/48.0'}
filename = 'cookie'

# 建立一个会话，可以把同一用户的不同请求联系起来；直到会话结束都会自动处理cookies
session = requests.Session()
# 建立LWPCookieJar实例，可以存Set-Cookie3类型的文件。
# 而MozillaCookieJar类是存为'/.txt'格式的文件
session.cookies = http.cookiejar.LWPCookieJar(filename)
# 若本地有cookie则不用再post数据了
try:
    # 参数ignore_discard=True表示即使cookies将被丢弃也把它保存下来
    # 它还有另外一个参数igonre_expires表示当前数据覆盖（overwritten）原文件
    session.cookies.load(filename=filename, ignore_discard=True)
except:
    print('Cookie未加载！')


def get_message():
    url = 'http://www.dpac.gov.cn/cpqxcj/VehicleComplaintPublicity.aspx'
    data = {"__VIEWSTATE":"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",
            "__VIEWSTATEGENERATOR":"31A172A6",
            "__EVENTTARGET":"pagelist",
            "__EVENTARGUMENT":"2",
            "__EVENTVALIDATION": "/wEWHwKd7b6hAgLV5KIqAvmFicsKArjloioC0oaJywoCl+WiKgKzhonLCgL646IqApSFicsKAtHloioC/YaJywoCtOaiKgLWh4nLCgKT5qIqAreHicsKAvbkoioCmIaJywoCzeaiKgKBiInLCgKw56IqAtqIicsKAtXktqUCAvmF9Y8LArjltqUCAtKG9Y8LApfltqUCArOG9Y8LAvrjtqUCApSF9Y8LAtHltqUCAv2G9Y8L9r4qB00NFeZtXBQFalHgwwA9rek=",
            "pagelist_input": "2"
            }
    result=session.post(url, data=data, headers=headers)
    print(result.text)

if __name__=='__main__':
    get_message()


